# Requirements Archive: v2.3 Field Inventory

**Archived:** 2026-02-02
**Status:** ✅ SHIPPED

This is the archived requirements specification for v2.3.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## v2.3 Requirements

Requirements for Field Inventory milestone. Each maps to roadmap phases.

### Backend API

- [x] **API-01**: Field stats endpoint returns per-field presence count, unique value count, and inferred type for a batch
- [x] **API-02**: Field stats query uses single aggregation (CTE/LATERAL join) — no N+1 per-field queries
- [x] **API-03**: Field values endpoint returns all distinct values for a specific field key across batch records
- [x] **API-04**: Field values endpoint supports pagination (limit/offset)
- [x] **API-05**: Both endpoints follow existing ownership validation pattern (project → batch chain, 404/403 separation)
- [x] **API-06**: Both endpoints apply soft-delete filtering and defense-in-depth (batch.projectId === projectId)

### Type Inference

- [x] **TYPE-01**: Type inference service detects STRING, NUMBER, DATE, BOOLEAN from sample values
- [x] **TYPE-02**: Type inference uses sample-based heuristics (5 values), not full-table scan
- [x] **TYPE-03**: Type inference lives in use case layer (not repository) per Clean Architecture
- [x] **TYPE-04**: Field stats response includes inferred type per field

### Field Inventory UI

- [x] **UI-01**: Field Inventory grid displays a card per field from batch columnMetadata
- [x] **UI-02**: Each field card shows field name, type badge, presence count (X of Y records), and unique value count
- [x] **UI-03**: View toggle switches between table view and field inventory on any batch
- [x] **UI-04**: PROFILE_MODE batches default to field inventory view, LIST_MODE defaults to table view
- [x] **UI-05**: Field cards are responsive (1 column mobile, 2 tablet, 3+ desktop)

### View Values Side Sheet

- [x] **SHEET-01**: Clicking a field card opens a side sheet showing all values for that field
- [x] **SHEET-02**: Side sheet includes debounced search input to filter displayed values
- [x] **SHEET-03**: Each value row has a copy button that copies to clipboard with toast feedback
- [x] **SHEET-04**: Side sheet fetches values on demand (only when opened, not pre-loaded)

### Loading & Empty States

- [x] **UX-01**: Skeleton cards display while field stats are loading
- [x] **UX-02**: Empty state shows when batch has no fields or no rows
- [x] **UX-03**: Loading indicator in side sheet while values are fetching
- [x] **UX-04**: Empty state in side sheet when field has no values

## Future Requirements

Deferred to later milestones. Tracked but not in current roadmap.

### Enhanced Type Detection

- **TYPE-05**: Detect domain-specific types (CPF, CNPJ, EMAIL, PHONE) via regex patterns
- **TYPE-06**: Return type confidence percentage (e.g., "80% match EMAIL pattern")

### Field Inventory Enhancements

- **UI-06**: Completeness heatmap gradient on field cards (red/yellow/green by presence ratio)
- **UI-07**: Sort/filter controls for field grid (A-Z, completeness, unique count)
- **UI-08**: Example values preview on field card (2-3 sample values without clicking)
- **UI-09**: Bulk copy all values (comma-separated or newline-separated)

### Performance

- **PERF-01**: GIN index on JSONB data column for field stats query optimization
- **PERF-02**: Virtual scrolling for value lists with 1000+ items

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Statistical distribution charts (histograms, box plots) | Populatte is for form-mapping preparation, not statistical analysis |
| Editable field values | Source of truth is Excel — edit there and re-upload |
| Auto data quality issue detection | We don't own data quality; users upload as-is |
| Pivot/aggregation features | Not a BI tool |
| Multi-batch field comparison | Single batch view sufficient for MVP |
| Automatic field-to-form mapping | Mapping happens in browser extension (future milestone) |
| Field-to-field relationship detection | Requires statistical library, deferred post-MVP |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| API-01 | Phase 17 | Complete |
| API-02 | Phase 17 | Complete |
| API-05 | Phase 17 | Complete |
| API-06 | Phase 17 | Complete |
| TYPE-01 | Phase 17 | Complete |
| TYPE-02 | Phase 17 | Complete |
| TYPE-03 | Phase 17 | Complete |
| TYPE-04 | Phase 17 | Complete |
| API-03 | Phase 18 | Complete |
| API-04 | Phase 18 | Complete |
| UI-01 | Phase 19 | Complete |
| UI-02 | Phase 19 | Complete |
| UI-03 | Phase 19 | Complete |
| UI-04 | Phase 19 | Complete |
| UI-05 | Phase 19 | Complete |
| UX-01 | Phase 19 | Complete |
| UX-02 | Phase 19 | Complete |
| SHEET-01 | Phase 20 | Complete |
| SHEET-02 | Phase 20 | Complete |
| SHEET-03 | Phase 20 | Complete |
| SHEET-04 | Phase 20 | Complete |
| UX-03 | Phase 20 | Complete |
| UX-04 | Phase 20 | Complete |

**Coverage:**
- v2.3 requirements: 23 total
- Shipped: 23 ✓
- Dropped: 0

---

## Milestone Summary

**Shipped:** 23 of 23 v2.3 requirements
**Adjusted:** None — all requirements implemented as specified
**Dropped:** None

---
*Archived: 2026-02-02 as part of v2.3 milestone completion*
